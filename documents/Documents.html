<html>
    <head>	<meta http-equiv="content-type" content="text/html;charset=UTF-8">
        <title>SIE 802.1X Client -- Documents</title>
    </head>
    <body>
        <pre>
===============================================================================
沈阳工程学院 - 校园网 802.1X 客户端 - 项目文档
-------------------------------------------------------------------------------
参考 AGanNo2 的相关介绍，在此将版本号加密/解密步骤整理如下。

[H3C 版本号加密流程]

选取任意 32 位随机数，并生成字符串形式的密钥
    uint32_t   randam;
    char       key[8+1];
    sprintf(key, "%08x", randam);


加密步骤：
char version[16]="EN V2.40-0335";
     ｜
     ｜   异或
     ｜《———————— key[]   (例如取 randam=0x12345678，则字符串 key[] 为 "12345678")
     ｜
version[16]: "LK%W3+19$5624  "
     ｜
     ｜   将整数 randam 附加到 version[16] 之后，组成 20 字节
     ｜《—————————————————————————————————————————————
     ｜
version[20]: "LK%W3+19$5624   4Vx"
     ｜
     ｜   异或
     ｜《——————— "HuaWei3COM1X"
     ｜
version[20]: "; <s23IJ%?C       "
     ｜
     ｜   按照 Base64 格式编码，输出可读的 ASCII 字符串
     ｜《——————————————————————————————————————————
     ｜
最后生成的 28 字节版本号为：
Rw0tZQEjdzIzSUolP0MNOyA8EHM=




[“异或”运算的细节]
1、每个密钥被按正序、逆序使用两遍
2、密钥会被扩展为与待加密数据长度相同

使用密钥 key[]="12345678" 加密 "EN V2.40-0335"：

    "EN V2.40-0335   "
    "1234567812345678"
XOR	"8765432187654321"
————————————————————————————————
    "LK%W3+19$5624   "



使用密钥 "HuaWei3COM1X" 加密 "LK%W3+19$5624   4Vx"：

    "LK%W3+19$5624   4Vx"
    "HuaWei3COM1XHuaWei3C"
XOR	"C3ieWauHX1MOC3ieWauH"
————————————————————————————————
    "; <s23IJ%?C       "




[H3C认证服务器解读版本号流程]

28字节版本号秘文
　　　｜
　　　｜　　Base64 解码
　　　｜《—————————————
　　　｜
verison[20]
　　　｜
　　　｜　　异或
　　　｜《————————　"HuaWei3COM1X"
　　　｜
version[20]
　　　｜　　\ 
　　　｜　　 \
　前 16 字节　　取出末尾 4 字节，即 randam
　　　｜　　　　　　　｜
　　　｜　　　　　　　｜
　　　｜　　　　　　　｜
　　　｜　　异或　　　｜
　　　｜《——————　key[]
　　　｜
　　　｜
还原成版本号字符串 "EN V2.40-0335"

===============================================================================
        </pre>
    </body>
</html>
